{"ast":null,"code":"// user.redux.js\nimport axios from 'axios'; // 用axios做请求\n\nimport { getRedirectPath } from '../utils'; // 定义常量\n\nconst REGISTER_SUCCESS = 'REGISTER_SUCCESS'; // 注册成功\n\nconst TODO_ERRSHOW = 'TODO_ERRSHOW'; // 操作失败\n\nconst GET_USER_INFO = 'GET_USER_INFO';\nconst toDoFail = 'toDoFail';\nconst loginSuccess = 'loginSuccess';\nconst loginOutSuccess = 'loginOutSuccess'; // state初始值\n\nconst initState = {\n  redirectTo: '',\n  // 完成之后跳到哪里\n  username: '',\n  // 账号\n  pwd: '',\n  // 密码\n  pwdConfirm: '',\n  // 确认密码\n  type: '',\n  // 用户类型\n  msg: '',\n  // 错误消息\n  isLogin: false // 是否登录\n\n};\nexport function user(state = initState, action) {\n  switch (action.type) {\n    case loginSuccess:\n      return { ...state,\n        msg: '',\n        redirectTo: getRedirectPath(action.payload),\n        ...action.payload\n      };\n\n    case REGISTER_SUCCESS:\n      return { ...state,\n        ...action.data,\n        msg: '',\n        redirectTo: '/login'\n      };\n\n    case TODO_ERRSHOW:\n      return { ...state,\n        msg: action.msg\n      };\n\n    default:\n      return state;\n  }\n}\n\nfunction registerFail(msg) {\n  return {\n    msg,\n    type: TODO_ERRSHOW\n  };\n}\n\nfunction registerSuccess(data) {\n  return {\n    data,\n    type: REGISTER_SUCCESS\n  };\n}\n\nexport function getUserInfo(userInfo) {\n  return {\n    type: GET_USER_INFO,\n    payload: userInfo\n  };\n} //login\n\nexport function login({\n  username,\n  pwd\n}) {\n  if (!username || !pwd) {\n    return toDoFail('账号密码不能为空');\n  }\n\n  return dispatch => {\n    axios.post('/user/login', {\n      username,\n      pwd\n    }).then(res => {\n      if (res.status === 200 && res.data.code === 0) {\n        dispatch(loginSuccess(res.data.data));\n      } else {\n        dispatch(toDoFail(res.data.msg));\n      }\n    });\n  };\n} // register是一个action creator ，返回的action供user这个reducer使用，从而改变state\n\nexport function register({\n  username,\n  pwd,\n  pwdConfirm,\n  type\n}) {\n  if (!username || !pwd) {\n    registerFail('账号密码不能为空');\n  }\n\n  if (pwd !== pwdConfirm) {\n    registerFail('两次密码不一致');\n  }\n\n  return dispatch => {\n    axios.post('/user/register', {\n      username,\n      pwd,\n      type\n    }).then(res => {\n      if (res.status === 200 && res.data.code === 0) {\n        dispatch(registerSuccess(res.data.data));\n      } else {\n        dispatch(registerFail(res.data.msg));\n      }\n    });\n  };\n}\nexport function loginOut() {\n  return dispatch => {\n    axios.get('/user/loginOut').then(res => {\n      if (res.status === 200 && res.data.code === 0) {\n        dispatch(loginOutSuccess(res.data.data));\n      } else {\n        dispatch(toDoFail(res.data.msg));\n      }\n    });\n  };\n}","map":{"version":3,"sources":["/Users/loki/feature1/Handy-Booking-Management-System/src/redux/user.redux.js"],"names":["axios","getRedirectPath","REGISTER_SUCCESS","TODO_ERRSHOW","GET_USER_INFO","toDoFail","loginSuccess","loginOutSuccess","initState","redirectTo","username","pwd","pwdConfirm","type","msg","isLogin","user","state","action","payload","data","registerFail","registerSuccess","getUserInfo","userInfo","login","dispatch","post","then","res","status","code","register","loginOut","get"],"mappings":"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","sourcesContent":["// user.redux.js\nimport axios from 'axios'; // 用axios做请求\nimport {getRedirectPath} from '../utils';\n\n// 定义常量\nconst REGISTER_SUCCESS = 'REGISTER_SUCCESS'; // 注册成功\nconst TODO_ERRSHOW = 'TODO_ERRSHOW'; // 操作失败\nconst GET_USER_INFO = 'GET_USER_INFO';\nconst toDoFail = 'toDoFail';\nconst loginSuccess = 'loginSuccess';\nconst loginOutSuccess ='loginOutSuccess';\n\n// state初始值\nconst initState = {\n    redirectTo: '', // 完成之后跳到哪里\n    username: '', // 账号\n    pwd: '', // 密码\n    pwdConfirm: '', // 确认密码\n    type: '', // 用户类型\n    msg: '', // 错误消息\n    isLogin: false // 是否登录\n}\n\nexport function user(state=initState,action) {\n    switch (action.type) {\n       case loginSuccess:\n            return {...state, msg:'', redirectTo:getRedirectPath(action.payload), ...action.payload} \n       case REGISTER_SUCCESS:\n            return {...state,...action.data, msg: '', redirectTo: '/login'}\n       case TODO_ERRSHOW:\n            return {...state,msg: action.msg}\n       default:\n            return state;\n    }\n}\n\nfunction registerFail(msg) {\n    return {\n        msg,\n        type: TODO_ERRSHOW\n    }\n}\n\nfunction registerSuccess(data) {\n    return {\n        data,\n        type: REGISTER_SUCCESS\n    }\n}\nexport function getUserInfo(userInfo) {\n    return {\n        type: GET_USER_INFO,\n        payload: userInfo\n    }    \n}\n//login\nexport function login({username,pwd}) {\n    if(!username || !pwd) {\n        return toDoFail('账号密码不能为空')\n    }\n    return dispatch => {\n        axios.post('/user/login',{username,pwd})\n            .then(res => {\n                if(res.status === 200 && res.data.code === 0) {\n                    dispatch(loginSuccess(res.data.data))\n                }else {\n                    dispatch(toDoFail(res.data.msg))\n                }\n            })\n    }\n}\n// register是一个action creator ，返回的action供user这个reducer使用，从而改变state\nexport function register({username,pwd,pwdConfirm,type}) {\n    if(!username || !pwd) {\n        registerFail('账号密码不能为空')\n    }\n    if(pwd !== pwdConfirm) {\n        registerFail('两次密码不一致')\n    }\n    return dispatch => {\n        axios.post('/user/register',{username,pwd,type})\n            .then(res => {\n                if(res.status === 200 && res.data.code === 0) {\n                    dispatch(registerSuccess(res.data.data))\n                }else {\n                    dispatch(registerFail(res.data.msg))\n                }\n            })\n    }\n}\nexport function loginOut() {\n    return dispatch => {\n        axios.get('/user/loginOut')\n                .then(res => {\n                if (res.status === 200 && res.data.code === 0) {\n                    dispatch(loginOutSuccess(res.data.data))\n                } else {\n                    dispatch(toDoFail(res.data.msg))\n                }\n            })\n    }\n}"]},"metadata":{},"sourceType":"module"}