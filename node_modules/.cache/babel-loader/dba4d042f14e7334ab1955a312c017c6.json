{"ast":null,"code":"// user.redux.js\nimport axios from 'axios'; // 用axios做请求\n\nimport { getRedirectPath } from '../utils'; // 定义常量\n\nconst REGISTER_SUCCESS = 'REGISTER_SUCCESS'; // 注册成功\n\nconst TODO_ERRSHOW = 'TODO_ERRSHOW'; // 操作失败\n\nconst GET_USER_INFO = 'GET_USER_INFO';\nconst toDoFail = 'toDoFail';\nconst loginSuccess = 'loginSuccess';\nconst loginOutSuccess = 'loginOutSuccess'; // state初始值\n\nconst initState = {\n  redirectTo: '',\n  // 完成之后跳到哪里\n  user: '',\n  // 账号\n  pwd: '',\n  // 密码\n  pwdConfirm: '',\n  // 确认密码\n  type: '',\n  // 用户类型\n  msg: '',\n  // 错误消息\n  isLogin: false // \n\n};\nexport function user(state = initState, action) {\n  switch (action.type) {\n    case loginSuccess:\n      return { ...state,\n        msg: '',\n        redirectTo: getRedirectPath(action.payload),\n        ...action.payload\n      };\n      return { ...state,\n        msg: '',\n        redirectTo: getRedirectPath(action.payload),\n        isAuth: true,\n        ...action.payload\n      };\n\n    case REGISTER_SUCCESS:\n      return { ...state,\n        ...action.data,\n        msg: '',\n        redirectTo: '/login'\n      };\n      return { ...state,\n        msg: '',\n        redirectTo: getRedirectPath(action.payload),\n        isAuth: true,\n        ...action.payload\n      };\n\n    case GET_USER_INFO:\n      return { ...state,\n        ...action.payload\n      };\n\n    case TODO_ERRSHOW:\n      return { ...state,\n        msg: action.msg\n      };\n      return { ...state,\n        isAuth: false,\n        msg: action.msg\n      };\n\n    default:\n      return state;\n  }\n}\n\nfunction registerFail(msg) {\n  return {\n    msg,\n    type: TODO_ERRSHOW\n  };\n}\n\nfunction errorMsg(msg) {\n  return {\n    msg,\n    type: toDoFail\n  };\n}\n\nfunction registerSuccess(data) {\n  return {\n    data,\n    type: REGISTER_SUCCESS\n  };\n}\n\nexport function getUserInfo(userInfo) {\n  return {\n    type: GET_USER_INFO,\n    payload: userInfo\n  };\n} //login\n\nexport function login({\n  user,\n  pwd\n}) {\n  if (!user || !pwd) {\n    return errorMsg('账号密码不能为空');\n  }\n\n  return dispatch => {\n    axios.post('/user/login', {\n      user,\n      pwd\n    }).then(res => {\n      if (res.status === 200 && res.data.code === 0) {\n        dispatch(loginSuccess(res.data.data));\n      } else {\n        dispatch(toDoFail(res.data.msg));\n      }\n    });\n  };\n} // register是一个action creator ，返回的action供user这个reducer使用，从而改变state\n\nexport function register({\n  user,\n  pwd,\n  pwdConfirm,\n  type\n}) {\n  if (!user || !pwd || !type) {\n    registerFail('账号密码不能为空');\n  }\n\n  if (pwd !== pwdConfirm) {\n    registerFail('两次密码不一致');\n  }\n\n  return dispatch => {\n    axios.post('/user/register', {\n      user,\n      pwd,\n      type\n    }).then(res => {\n      if (res.status === 200 && res.data.code === 0) {\n        dispatch(registerSuccess(res.data.data));\n      } else {\n        dispatch(registerFail(res.data.msg));\n      }\n    });\n  };\n}\nexport function loginOut() {\n  return dispatch => {\n    axios.get('/user/loginOut').then(res => {\n      if (res.status === 200 && res.data.code === 0) {\n        dispatch(loginOutSuccess(res.data.data));\n      } else {\n        dispatch(toDoFail(res.data.msg));\n      }\n    });\n  };\n}","map":{"version":3,"sources":["/Users/loki/feature1/Handy-Booking-Management-System/src/redux/user.redux.js"],"names":["axios","getRedirectPath","REGISTER_SUCCESS","TODO_ERRSHOW","GET_USER_INFO","toDoFail","loginSuccess","loginOutSuccess","initState","redirectTo","user","pwd","pwdConfirm","type","msg","isLogin","state","action","payload","isAuth","data","registerFail","errorMsg","registerSuccess","getUserInfo","userInfo","login","dispatch","post","then","res","status","code","register","loginOut","get"],"mappings":"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","sourcesContent":["// user.redux.js\nimport axios from 'axios'; // 用axios做请求\nimport {getRedirectPath} from '../utils';\n\n// 定义常量\nconst REGISTER_SUCCESS = 'REGISTER_SUCCESS'; // 注册成功\nconst TODO_ERRSHOW = 'TODO_ERRSHOW'; // 操作失败\nconst GET_USER_INFO = 'GET_USER_INFO';\nconst toDoFail = 'toDoFail';\nconst loginSuccess = 'loginSuccess';\nconst loginOutSuccess ='loginOutSuccess';\n\n// state初始值\nconst initState = {\n    redirectTo: '', // 完成之后跳到哪里\n    user: '', // 账号\n    pwd: '', // 密码\n    pwdConfirm: '', // 确认密码\n    type: '', // 用户类型\n    msg: '', // 错误消息\n    isLogin: false // \n}\n\nexport function user(state=initState,action) {\n    switch (action.type) {\n       case loginSuccess:\n            return {...state, msg:'', redirectTo:getRedirectPath(action.payload), ...action.payload} \n            return {...state, msg:'',redirectTo:getRedirectPath(action.payload),isAuth:true,...action.payload}\n       case REGISTER_SUCCESS:\n            return {...state,...action.data, msg: '', redirectTo: '/login'}\n            return {...state, msg:'',redirectTo:getRedirectPath(action.payload),isAuth:true,...action.payload}\n       case GET_USER_INFO:\n           return {...state,...action.payload}\n       case TODO_ERRSHOW:\n            return {...state,msg: action.msg}\n            return {...state, isAuth:false, msg:action.msg}\n       default:\n            return state;\n    }\n}\n\nfunction registerFail(msg) {\n    return {\n        msg,\n        type: TODO_ERRSHOW\n    }\n}\nfunction errorMsg(msg){\n    return { \n        msg, \n        type:toDoFail \n    }\n}\n\nfunction registerSuccess(data) {\n    return {\n        data,\n        type: REGISTER_SUCCESS\n    }\n}\nexport function getUserInfo(userInfo) {\n    return {\n        type: GET_USER_INFO,\n        payload: userInfo\n    }    \n}\n//login\nexport function login({user,pwd}) {\n    if(!user || !pwd) {\n        return errorMsg('账号密码不能为空')\n    }\n    return dispatch => {\n        axios.post('/user/login',{user,pwd})\n            .then(res => {\n                if(res.status === 200 && res.data.code === 0) {\n                    dispatch(loginSuccess(res.data.data))\n                }else {\n                    dispatch(toDoFail(res.data.msg))\n                }\n            })\n    }\n}\n// register是一个action creator ，返回的action供user这个reducer使用，从而改变state\nexport function register({user,pwd,pwdConfirm,type}) {\n    if(!user || !pwd|| !type) {\n        registerFail('账号密码不能为空')\n    }\n    if(pwd !== pwdConfirm) {\n        registerFail('两次密码不一致')\n    }\n    return dispatch => {\n        axios.post('/user/register',{user,pwd,type})\n            .then(res => {\n                if(res.status === 200 && res.data.code === 0) {\n                    dispatch(registerSuccess(res.data.data))\n                }else {\n                    dispatch(registerFail(res.data.msg))\n                }\n            })\n    }\n}\nexport function loginOut() {\n    return dispatch => {\n        axios.get('/user/loginOut')\n                .then(res => {\n                if (res.status === 200 && res.data.code === 0) {\n                    dispatch(loginOutSuccess(res.data.data))\n                } else {\n                    dispatch(toDoFail(res.data.msg))\n                }\n            })\n    }\n}"]},"metadata":{},"sourceType":"module"}