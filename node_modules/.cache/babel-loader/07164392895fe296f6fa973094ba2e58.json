{"ast":null,"code":"var _dec,\n    _class,\n    _temp,\n    _jsxFileName = \"/Users/loki/feature1/Handy-Booking-Management-System/src/routes/Login/index.js\";\n\nimport React from 'react';\nimport BGParticle from '../../utils/BGParticle';\nimport { notification } from 'antd';\nimport './style.css';\nimport { withRouter } from 'react-router-dom';\nimport { inject, observer } from 'mobx-react/index';\nimport Loading2 from '../../components/Loading2';\nimport { preloadingImages } from '../../utils/utils';\nimport 'animate.css';\nimport LoginForm from './LoginForm';\nimport RegisterForm from './RegisterForm';\nconst url = 'https://github.com/zhangZhiHao1996/image-store/blob/master/react-admin-master/bg1.jpg?raw=true';\nconst imgs = ['https://github.com/zhangZhiHao1996/image-store/blob/master/react-admin-master/slide1.jpg?raw=true', 'https://github.com/zhangZhiHao1996/image-store/blob/master/react-admin-master/slide2.jpg?raw=true', 'https://github.com/zhangZhiHao1996/image-store/blob/master/react-admin-master/slide3.jpg?raw=true', 'https://github.com/zhangZhiHao1996/image-store/blob/master/react-admin-master/slide4.jpg?raw=true'];\nlet Login = (_dec = inject('appStore'), withRouter(_class = _dec(_class = observer(_class = (_temp = class Login extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      showBox: 'login',\n      //展示当前表单\n      url: '',\n      //背景图片\n      loading: false,\n      loading2: false\n    };\n\n    this.initPage = () => {\n      this.setState({\n        loading: true\n      });\n      this.props.appStore.initUsers();\n      this.loadImageAsync(url).then(url => {\n        this.setState({\n          loading: false,\n          url\n        });\n      }).then(() => {\n        //为什么写在then里？id为backgroundBox的DOM元素是在loading为false时才有，而上面的setState可能是异步的，必须等到setState执行完成后才去获取dom\n        this.particle = new BGParticle('backgroundBox');\n        this.particle.init();\n        notification.open({\n          message: /*#__PURE__*/React.createElement(\"ul\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 64,\n              columnNumber: 17\n            }\n          }, /*#__PURE__*/React.createElement(\"li\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 64,\n              columnNumber: 21\n            }\n          }, \"\\u521D\\u59CB\\u8D26\\u53F7\\uFF1Aadmin\"), /*#__PURE__*/React.createElement(\"li\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 64,\n              columnNumber: 40\n            }\n          }, \"\\u521D\\u59CB\\u5BC6\\u7801\\uFF1Aadmin\")),\n          duration: 0,\n          className: 'login-notification'\n        });\n      });\n    };\n\n    this.switchShowBox = box => {\n      this.setState({\n        showBox: box\n      });\n    };\n  }\n\n  componentDidMount() {\n    const isLogin = this.props.appStore;\n\n    if (isLogin) {\n      this.props.history.go(1); //当浏览器用后退按钮回到登录页时，判断登录页是否登录，是登录就重定向上个页面\n      // this.props.appStore.toggleLogin(false) //也可以设置退出登录\n    }\n\n    this.initPage();\n    preloadingImages(imgs); //预加载下一个页面的图片，预加载了第二次为什么还会去请求图片资源？\n  }\n\n  componentWillUnmount() {\n    this.particle && this.particle.destory();\n    notification.destroy();\n  } //载入页面时的一些处理\n\n\n  //登录的背景图太大，等载入完后再显示，实际上是图片预加载，\n  loadImageAsync(url) {\n    return new Promise(function (resolve, reject) {\n      const image = new Image();\n\n      image.onload = function () {\n        resolve(url);\n      };\n\n      image.onerror = function () {\n        console.log('图片载入错误');\n      };\n\n      image.src = url;\n    });\n  }\n\n  render() {\n    const {\n      showBox,\n      loading\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      id: \"login-page\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 7\n      }\n    }, loading ? /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      style: styles.loadingTitle,\n      className: \"animated bounceInLeft\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 15\n      }\n    }, \"\\u8F7D\\u5165\\u4E2D...\"), /*#__PURE__*/React.createElement(Loading2, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 15\n      }\n    })) : /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: \"backgroundBox\",\n      style: styles.backgroundBox,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(LoginForm, {\n      className: showBox === 'login' ? 'box showBox' : 'box hiddenBox',\n      switchShowBox: this.switchShowBox,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(RegisterForm, {\n      className: showBox === 'register' ? 'box showBox' : 'box hiddenBox',\n      switchShowBox: this.switchShowBox,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 17\n      }\n    }))));\n  }\n\n}, _temp)) || _class) || _class) || _class);\nconst styles = {\n  backgroundBox: {\n    position: 'fixed',\n    top: '0',\n    left: '0',\n    width: '100vw',\n    height: '100vh',\n    // backgroundImage: 'url(https://github.com/zhangZhiHao1996/image-store/blob/master/react-admin-master/bg5.jpg?raw=true)',\n    backgroundImage: 'url(https://github.com/zhangZhiHao1996/image-store/blob/master/react-admin-master/bg1.jpg?raw=true)',\n    backgroundSize: '100% 100%',\n    transition: 'all .5s'\n  },\n  focus: {\n    // transform: 'scale(0.7)',\n    width: '20px',\n    opacity: 1\n  },\n  loadingBox: {\n    position: 'fixed',\n    top: '50%',\n    left: '50%',\n    transform: 'translate(-50%,-50%)'\n  },\n  loadingTitle: {\n    position: 'fixed',\n    top: '50%',\n    left: '50%',\n    marginLeft: -45,\n    marginTop: -18,\n    color: '#000',\n    fontWeight: 500,\n    fontSize: 24\n  }\n};\nexport default Login;","map":{"version":3,"sources":["/Users/loki/feature1/Handy-Booking-Management-System/src/routes/Login/index.js"],"names":["React","BGParticle","notification","withRouter","inject","observer","Loading2","preloadingImages","LoginForm","RegisterForm","url","imgs","Login","Component","state","showBox","loading","loading2","initPage","setState","props","appStore","initUsers","loadImageAsync","then","particle","init","open","message","duration","className","switchShowBox","box","componentDidMount","isLogin","history","go","componentWillUnmount","destory","destroy","Promise","resolve","reject","image","Image","onload","onerror","console","log","src","render","styles","loadingTitle","backgroundBox","position","top","left","width","height","backgroundImage","backgroundSize","transition","focus","opacity","loadingBox","transform","marginLeft","marginTop","color","fontWeight","fontSize"],"mappings":";;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,UAAP,MAAuB,wBAAvB;AACA,SAASC,YAAT,QAA6B,MAA7B;AACA,OAAO,aAAP;AACA,SAASC,UAAT,QAA2B,kBAA3B;AACA,SAASC,MAAT,EAAiBC,QAAjB,QAAiC,kBAAjC;AACA,OAAOC,QAAP,MAAqB,2BAArB;AACA,SAAQC,gBAAR,QAA+B,mBAA/B;AACA,OAAO,aAAP;AACA,OAAOC,SAAP,MAAsB,aAAtB;AACA,OAAOC,YAAP,MAAyB,gBAAzB;AAEA,MAAMC,GAAG,GAAG,gGAAZ;AACA,MAAMC,IAAI,GAAG,CACX,mGADW,EAEX,mGAFW,EAGX,mGAHW,EAIX,mGAJW,CAAb;IAYMC,K,WADOR,MAAM,CAAC,UAAD,C,EAAlBD,U,wBAAgCE,Q,mBAAjC,MACMO,KADN,SACoBZ,KAAK,CAACa,SAD1B,CACoC;AAAA;AAAA;AAAA,SAClCC,KADkC,GAC1B;AACNC,MAAAA,OAAO,EAAE,OADH;AACc;AACpBL,MAAAA,GAAG,EAAE,EAFC;AAEI;AACVM,MAAAA,OAAO,EAAC,KAHF;AAINC,MAAAA,QAAQ,EAAC;AAJH,KAD0B;;AAAA,SAuBlCC,QAvBkC,GAuBvB,MAAM;AACf,WAAKC,QAAL,CAAc;AACZH,QAAAA,OAAO,EAAC;AADI,OAAd;AAGA,WAAKI,KAAL,CAAWC,QAAX,CAAoBC,SAApB;AACA,WAAKC,cAAL,CAAoBb,GAApB,EAAyBc,IAAzB,CAA8Bd,GAAG,IAAE;AACjC,aAAKS,QAAL,CAAc;AACZH,UAAAA,OAAO,EAAC,KADI;AAEZN,UAAAA;AAFY,SAAd;AAID,OALD,EAKGc,IALH,CAKQ,MAAI;AACV;AACA,aAAKC,QAAL,GAAgB,IAAIxB,UAAJ,CAAe,eAAf,CAAhB;AACA,aAAKwB,QAAL,CAAcC,IAAd;AACAxB,QAAAA,YAAY,CAACyB,IAAb,CAAkB;AAChBC,UAAAA,OAAO,eAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mDAAJ,eAAuB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mDAAvB,CADQ;AAEhBC,UAAAA,QAAQ,EAAC,CAFO;AAGhBC,UAAAA,SAAS,EAAC;AAHM,SAAlB;AAKD,OAdD;AAeD,KA3CiC;;AAAA,SA6ClCC,aA7CkC,GA6CjBC,GAAD,IAAS;AACvB,WAAKb,QAAL,CAAc;AACZJ,QAAAA,OAAO,EAAEiB;AADG,OAAd;AAGD,KAjDiC;AAAA;;AAQlCC,EAAAA,iBAAiB,GAAI;AACnB,UAAMC,OAAO,GAAG,KAAKd,KAAL,CAAWC,QAA3B;;AACA,QAAGa,OAAH,EAAW;AACT,WAAKd,KAAL,CAAWe,OAAX,CAAmBC,EAAnB,CAAsB,CAAtB,EADS,CACoB;AAC7B;AACD;;AACD,SAAKlB,QAAL;AACAX,IAAAA,gBAAgB,CAACI,IAAD,CAAhB,CAPmB,CAOK;AACzB;;AAED0B,EAAAA,oBAAoB,GAAI;AACtB,SAAKZ,QAAL,IAAiB,KAAKA,QAAL,CAAca,OAAd,EAAjB;AACApC,IAAAA,YAAY,CAACqC,OAAb;AACD,GArBiC,CAsBlC;;;AA6BA;AACAhB,EAAAA,cAAc,CAAEb,GAAF,EAAO;AACnB,WAAO,IAAI8B,OAAJ,CAAY,UAASC,OAAT,EAAkBC,MAAlB,EAA0B;AAC3C,YAAMC,KAAK,GAAG,IAAIC,KAAJ,EAAd;;AACAD,MAAAA,KAAK,CAACE,MAAN,GAAe,YAAW;AACxBJ,QAAAA,OAAO,CAAC/B,GAAD,CAAP;AACD,OAFD;;AAGAiC,MAAAA,KAAK,CAACG,OAAN,GAAgB,YAAW;AACzBC,QAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ;AACD,OAFD;;AAGAL,MAAAA,KAAK,CAACM,GAAN,GAAYvC,GAAZ;AACD,KATM,CAAP;AAUD;;AAEDwC,EAAAA,MAAM,GAAI;AACR,UAAM;AAACnC,MAAAA,OAAD;AAASC,MAAAA;AAAT,QAAoB,KAAKF,KAA/B;AACA,wBACE;AAAK,MAAA,EAAE,EAAC,YAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAEIE,OAAO,gBACL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAI,MAAA,KAAK,EAAEmC,MAAM,CAACC,YAAlB;AAAgC,MAAA,SAAS,EAAC,uBAA1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BADF,eAEE,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,CADK,gBAKL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,EAAE,EAAC,eAAR;AAAwB,MAAA,KAAK,EAAED,MAAM,CAACE,aAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,eAEE;AAAK,MAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,SAAD;AACE,MAAA,SAAS,EAAEtC,OAAO,KAAK,OAAZ,GAAsB,aAAtB,GAAsC,eADnD;AAEE,MAAA,aAAa,EAAE,KAAKgB,aAFtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,eAIE,oBAAC,YAAD;AACE,MAAA,SAAS,EAAEhB,OAAO,KAAK,UAAZ,GAAyB,aAAzB,GAAyC,eADtD;AAEE,MAAA,aAAa,EAAE,KAAKgB,aAFtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAJF,CAFF,CAPN,CADF;AAsBD;;AAzFiC,C;AA4FpC,MAAMoB,MAAM,GAAG;AACbE,EAAAA,aAAa,EAAE;AACbC,IAAAA,QAAQ,EAAE,OADG;AAEbC,IAAAA,GAAG,EAAE,GAFQ;AAGbC,IAAAA,IAAI,EAAE,GAHO;AAIbC,IAAAA,KAAK,EAAE,OAJM;AAKbC,IAAAA,MAAM,EAAE,OALK;AAMb;AACAC,IAAAA,eAAe,EAAE,qGAPJ;AAQbC,IAAAA,cAAc,EAAE,WARH;AASbC,IAAAA,UAAU,EAAC;AATE,GADF;AAYbC,EAAAA,KAAK,EAAE;AACL;AACAL,IAAAA,KAAK,EAAE,MAFF;AAGLM,IAAAA,OAAO,EAAE;AAHJ,GAZM;AAiBbC,EAAAA,UAAU,EAAC;AACTV,IAAAA,QAAQ,EAAC,OADA;AAETC,IAAAA,GAAG,EAAC,KAFK;AAGTC,IAAAA,IAAI,EAAC,KAHI;AAITS,IAAAA,SAAS,EAAC;AAJD,GAjBE;AAuBbb,EAAAA,YAAY,EAAC;AACXE,IAAAA,QAAQ,EAAC,OADE;AAEXC,IAAAA,GAAG,EAAC,KAFO;AAGXC,IAAAA,IAAI,EAAC,KAHM;AAIXU,IAAAA,UAAU,EAAE,CAAC,EAJF;AAKXC,IAAAA,SAAS,EAAE,CAAC,EALD;AAMXC,IAAAA,KAAK,EAAC,MANK;AAOXC,IAAAA,UAAU,EAAC,GAPA;AAQXC,IAAAA,QAAQ,EAAC;AARE;AAvBA,CAAf;AAmCA,eAAe1D,KAAf","sourcesContent":["import React from 'react'\nimport BGParticle from '../../utils/BGParticle'\nimport { notification } from 'antd'\nimport './style.css'\nimport { withRouter } from 'react-router-dom'\nimport { inject, observer } from 'mobx-react/index'\nimport Loading2 from '../../components/Loading2'\nimport {preloadingImages} from '../../utils/utils'\nimport 'animate.css'\nimport LoginForm from './LoginForm'\nimport RegisterForm from './RegisterForm'\n\nconst url = 'https://github.com/zhangZhiHao1996/image-store/blob/master/react-admin-master/bg1.jpg?raw=true'\nconst imgs = [\n  'https://github.com/zhangZhiHao1996/image-store/blob/master/react-admin-master/slide1.jpg?raw=true',\n  'https://github.com/zhangZhiHao1996/image-store/blob/master/react-admin-master/slide2.jpg?raw=true',\n  'https://github.com/zhangZhiHao1996/image-store/blob/master/react-admin-master/slide3.jpg?raw=true',\n  'https://github.com/zhangZhiHao1996/image-store/blob/master/react-admin-master/slide4.jpg?raw=true'\n]\n\n\n\n\n\n@withRouter @inject('appStore') @observer\nclass Login extends React.Component {\n  state = {\n    showBox: 'login',   //展示当前表单\n    url: '',  //背景图片\n    loading:false,\n    loading2:false,\n  }\n\n  componentDidMount () {\n    const isLogin = this.props.appStore\n    if(isLogin){\n      this.props.history.go(1)     //当浏览器用后退按钮回到登录页时，判断登录页是否登录，是登录就重定向上个页面\n      // this.props.appStore.toggleLogin(false) //也可以设置退出登录\n    }\n    this.initPage()\n    preloadingImages(imgs)  //预加载下一个页面的图片，预加载了第二次为什么还会去请求图片资源？\n  }\n\n  componentWillUnmount () {\n    this.particle && this.particle.destory()\n    notification.destroy()\n  }\n  //载入页面时的一些处理\n  initPage = () => {\n    this.setState({\n      loading:true\n    })\n    this.props.appStore.initUsers()\n    this.loadImageAsync(url).then(url=>{\n      this.setState({\n        loading:false,\n        url\n      })\n    }).then(()=>{\n      //为什么写在then里？id为backgroundBox的DOM元素是在loading为false时才有，而上面的setState可能是异步的，必须等到setState执行完成后才去获取dom\n      this.particle = new BGParticle('backgroundBox')\n      this.particle.init()\n      notification.open({\n        message:<ul><li>初始账号：admin</li><li>初始密码：admin</li></ul>,\n        duration:0,\n        className:'login-notification'\n      })\n    })\n  }\n  //切换showbox\n  switchShowBox = (box) => {\n    this.setState({\n      showBox: box\n    })\n  }\n\n  //登录的背景图太大，等载入完后再显示，实际上是图片预加载，\n  loadImageAsync (url) {\n    return new Promise(function(resolve, reject) {\n      const image = new Image();\n      image.onload = function() {\n        resolve(url);\n      };\n      image.onerror = function() {\n        console.log('图片载入错误')\n      };\n      image.src = url;\n    });\n  }\n\n  render () {\n    const {showBox,loading} = this.state\n    return (\n      <div id='login-page'>\n        {\n          loading ?\n            <div>\n              <h3 style={styles.loadingTitle} className='animated bounceInLeft'>载入中...</h3>\n              <Loading2/>\n            </div>:\n            <div>\n              <div id='backgroundBox' style={styles.backgroundBox}/>\n              <div className='container'>\n                <LoginForm\n                  className={showBox === 'login' ? 'box showBox' : 'box hiddenBox'}\n                  switchShowBox={this.switchShowBox}/>\n                <RegisterForm\n                  className={showBox === 'register' ? 'box showBox' : 'box hiddenBox'}\n                  switchShowBox={this.switchShowBox}/>\n              </div>\n            </div>\n        }\n      </div>\n    )\n  }\n}\n\nconst styles = {\n  backgroundBox: {\n    position: 'fixed',\n    top: '0',\n    left: '0',\n    width: '100vw',\n    height: '100vh',\n    // backgroundImage: 'url(https://github.com/zhangZhiHao1996/image-store/blob/master/react-admin-master/bg5.jpg?raw=true)',\n    backgroundImage: 'url(https://github.com/zhangZhiHao1996/image-store/blob/master/react-admin-master/bg1.jpg?raw=true)',\n    backgroundSize: '100% 100%',\n    transition:'all .5s'\n  },\n  focus: {\n    // transform: 'scale(0.7)',\n    width: '20px',\n    opacity: 1\n  },\n  loadingBox:{\n    position:'fixed',\n    top:'50%',\n    left:'50%',\n    transform:'translate(-50%,-50%)'\n  },\n  loadingTitle:{\n    position:'fixed',\n    top:'50%',\n    left:'50%',\n    marginLeft: -45,\n    marginTop: -18,\n    color:'#000',\n    fontWeight:500,\n    fontSize:24\n  },\n}\n\nexport default Login\n"]},"metadata":{},"sourceType":"module"}